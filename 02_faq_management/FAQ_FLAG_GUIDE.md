# FAQ Web反映フラグ管理ガイド

## 概要
このシステムは、Docbase内のFAQにWeb反映の制御フラグを付けて、一括Web更新時に特定のFAQを除外できる機能です。

## フラグの仕組み

### マークダウン表記
```markdown
#### Q: 質問内容
- [ ] Web反映対象    ← チェックなし：Web反映する
**A:** 回答内容

#### Q: 別の質問
- [x] Web反映除外    ← チェックあり：Web反映しない
**A:** 別の回答
```

### フラグの意味
- `- [ ] Web反映対象`：Webサイトに反映する（チェックボックス空）
- `- [x] Web反映除外`：Webサイトから除外する（チェックボックス✓）
- フラグなし：デフォルトでWeb反映対象として扱う

## 使用方法

### 1. フラグ管理システム
```bash
cd /Users/g.ohorudingusu/Docbase
python faq_flag_manager.py
```

#### 機能メニュー
1. **FAQフラグ状況を分析**：現在のフラグ状況を確認
2. **すべてのFAQにフラグを追加**：フラグがないFAQに自動でフラグ追加
3. **特定のFAQフラグを切り替え**：個別にフラグを変更
4. **記事を更新**：Docbaseに変更を反映
5. **終了**

### 2. Web反映用データ抽出
```bash
cd /Users/g.ohorudingusu/Docbase
python web_sync_filter.py
```

#### 出力形式
1. **JSON形式**：API連携用
2. **Markdown形式**：ドキュメント用
3. **HTML形式**：Webページ用
4. **除外FAQレポート**：除外されたFAQのリスト
5. **すべての形式で出力**：一括出力

## 実用例

### 例1：テスト中のFAQを除外
```markdown
#### Q: 新機能についての質問（テスト中）
- [x] Web反映除外
**A:** この機能はまだテスト中です...
```

### 例2：社内向けFAQを除外
```markdown
#### Q: 社内システムの使い方
- [x] Web反映除外
**A:** 社内専用の情報...
```

### 例3：通常のWeb公開FAQ
```markdown
#### Q: 商品の使用方法について
- [ ] Web反映対象
**A:** 以下の手順で使用してください...
```

## フラグの切り替え手順

### コマンドライン操作
1. `python faq_flag_manager.py`を実行
2. メニューで「3. 特定のFAQフラグを切り替え」を選択
3. セクション名を入力（例：ポイントクーラー）
4. 質問の一部を入力（例：洗濯）
5. 除外設定するかを選択（y/N）

### 手動編集
Docbase画面で直接編集も可能：
- `- [ ] Web反映対象` → `- [x] Web反映除外`
- `- [x] Web反映除外` → `- [ ] Web反映対象`

## Web反映ワークフロー

### 1. 事前準備
```bash
# フラグ状況を確認
python faq_flag_manager.py
# メニューで「1. FAQフラグ状況を分析」を選択
```

### 2. 除外FAQの設定
必要に応じて除外フラグを設定：
- テスト中の内容
- 社内専用情報
- 古い情報
- 不完全な回答

### 3. Web用データ抽出
```bash
# Web反映用ファイルを生成
python web_sync_filter.py
# メニューで「5. すべての形式で出力」を選択
```

### 4. 出力ファイル確認
- `web_faqs.json`：API用データ
- `web_faqs.md`：Markdown形式
- `web_faqs.html`：HTML形式
- `excluded_faqs_report.md`：除外FAQレポート

## 出力ファイル形式

### JSON形式（web_faqs.json）
```json
{
  "summary": {
    "total_sections": 10,
    "total_faqs": 95,
    "target_faqs": 85,
    "excluded_faqs": 10
  },
  "sections": [
    {
      "section_name": "❄️ ポイントクーラー",
      "faqs": [
        {
          "question": "どのくらいの時間冷却効果が持続しますか？",
          "answer": "保冷剤を冷凍庫で十分に凍らせた場合、約2-4時間の冷却効果が期待できます。"
        }
      ]
    }
  ]
}
```

### Markdown形式（web_faqs.md）
```markdown
# よくある質問（FAQ）

※ Web反映対象: 85件 / 総FAQ数: 95件

## ❄️ ポイントクーラー

### Q: どのくらいの時間冷却効果が持続しますか？
**A:** 保冷剤を冷凍庫で十分に凍らせた場合、約2-4時間の冷却効果が期待できます。
```

## トラブルシューティング

### フラグが認識されない
1. **チェックボックス形式の確認**
   - 正：`- [ ] Web反映対象`
   - 誤：`-[ ]Web反映対象`（スペースなし）

2. **文字列の完全一致**
   - 正：`- [x] Web反映除外`
   - 誤：`- [x] Web反映から除外`

### セクションが見つからない
1. **セクション名の確認**
   - 絵文字を含む正確な名前を入力
   - 例：「ポイントクーラー」（「❄️ ポイントクーラー」ではない）

2. **質問の部分一致**
   - 質問文の一部分を入力
   - 例：「洗濯」で「洗濯はできますか？」にマッチ

### 更新が反映されない
1. **権限の確認**
   - APIトークンの有効性
   - 記事編集権限

2. **ネットワーク接続**
   - インターネット接続の確認
   - Docbase APIの状態

## 運用のベストプラクティス

### 1. 定期的なフラグ見直し
- 月1回程度、フラグ状況を分析
- 不要な除外フラグの解除
- 新しく追加されたFAQのフラグ設定

### 2. 除外理由の明確化
除外FAQには理由をコメントで記載：
```markdown
#### Q: テスト中の新機能について
- [x] Web反映除外  <!-- 2025年8月リリース予定まで除外 -->
**A:** この機能は現在開発中です...
```

### 3. バックアップの取得
フラグ変更前には必ずバックアップ：
```bash
python get_article.py  # 記事をバックアップ
```

### 4. チーム内での共有
- フラグ変更時はチームに通知
- 除外理由の文書化
- 定期的なレビュー会議

## API連携用出力

### Web API向けJSON構造
```javascript
// フロントエンド側での使用例
fetch('./web_faqs.json')
  .then(response => response.json())
  .then(data => {
    // Web反映対象のFAQのみが含まれている
    data.sections.forEach(section => {
      section.faqs.forEach(faq => {
        // FAQをWebページに表示
        displayFAQ(faq.question, faq.answer);
      });
    });
  });
```

### CMS連携
- WordPress、Drupal等のCMSへのインポート用
- JSON形式またはMarkdown形式を利用
- 除外フラグによる自動フィルタリング

---

**作成日**: 2025年7月23日  
**バージョン**: 1.0  
**対応記事**: Docbase記事ID 2705590