{
  "id": 3891568,
  "title": "📦 Amazon FBA棚卸しシステム - 完全操作ガイド（噛み砕き版）",
  "body": "# 📦 Amazon FBA棚卸しシステム - 完全操作ガイド\r\n\r\n## 🎯 このシステムで何ができるの？\r\n\r\n**Amazon販売者の在庫管理を完全自動化！**\r\n\r\n- **📊 在庫CSV** → **🤖 自動処理** → **💰 在庫金額計算完了**\r\n- 手作業での転記・計算が**ゼロ**になります\r\n- 月末棚卸しが**10分**で完了します\r\n\r\n### ✨ 主な機能\r\n- 🔄 **AmazonのCSV在庫データ自動取り込み**\r\n- 💰 **在庫金額の自動計算**（原価 × 在庫数 × 倍率）\r\n- 📋 **商品情報との自動マッチング**\r\n- 🎯 **手動調整値の保持**（輸送中在庫・修正分）\r\n\r\n## 🏢 統合在庫管理システム体制\r\n\r\n### 📊 4システム連携体制（2025年8月現在）\r\n\r\nこのFBA棚卸しシステムは、以下の統合在庫管理システムの一部として運用されています：\r\n\r\n1. **📦 FBA棚卸しシステム**（本システム）- Amazon倉庫在庫の自動管理\r\n2. **🛒 RSL棚卸しシステム** - 楽天ロジの在庫連携システム  \r\n3. **🏭 EF（加島商事）棚卸しシステム** - 加島商事との在庫統合システム\r\n4. **📈 統合月次レポートシステム** - 全在庫データの包括分析\r\n\r\n### 🔗 システム間連携の特徴\r\n- **統一されたSKU管理**: 全システムで共通のSKU正規化機能\r\n- **データ形式統一**: 同一フォーマットでの出力・連携対応\r\n- **月次統合分析**: 複数倉庫・チャネルの在庫を一元分析\r\n- **共通設定管理**: PropertiesServiceによる設定永続化\r\n\r\n---\r\n\r\n## 🚀 初回セットアップ（10分でできる）\r\n\r\n### Step 1: スプレッドシートの準備\r\n\r\n1. **📊 専用スプレッドシートを開く**\r\n   ```\r\n   https://docs.google.com/spreadsheets/d/117-5Z6LbuoAkcNCmjFy88iBCPjW5EYBeMo-5TgjYpkE\r\n   ```\r\n\r\n2. **🛠️ Apps Scriptエディタを開く**\r\n   - メニュー「拡張機能」→「Apps Script」をクリック\r\n   - 新しいタブでエディタが開きます\r\n\r\n3. **📋 スクリプトコードを設置**\r\n   - 既存コードを**全削除**\r\n   - 提供されたスクリプトを**貼り付け**\r\n   - **保存**（Ctrl+S）\r\n\r\n4. **✅ 権限の承認**\r\n   - 初回実行時に「権限が必要です」と表示されたら「許可」をクリック\r\n   - Googleアカウントで承認\r\n\r\n### Step 2: メニューの確認\r\n\r\nスプレッドシートに戻ると、**「棚卸しシステム」**メニューが追加されています！\r\n\r\n**🔧 利用可能な機能：**\r\n- **📥 在庫データ取り込み実行** ← メインの機能\r\n- **⚙️ 設定変更** ← フォルダ・シート設定\r\n- **📊 マスターデータをアップロード** ← 商品情報管理\r\n\r\n---\r\n\r\n## 📋 商品マスターデータの準備\r\n\r\n### Step 1: マスターデータシート作成\r\n\r\n1. **メニューから実行**\r\n   ```\r\n   「棚卸しシステム」→「📊 マスターデータをアップロード」\r\n   ```\r\n\r\n2. **「マスターデータシートを作成」をクリック**\r\n   - 新しい「マスターデータ」タブが作成されます\r\n\r\n### Step 2: 商品情報の入力\r\n\r\n**📝 入力するデータ例：**\r\n\r\n| SKU | 商品名 | 税抜き原価 | 倍率 |\r\n|-----|--------|------------|------|\r\n| l0788 | SmartTap タブレット車載ホルダー | 1000 | 1.5 |\r\n| l0910 | 車載ホルダー スマホスタンド | 2000 | 1.0 |\r\n| l0890 | オートホールド式 バイクホルダー | 1500 | 2.0 |\r\n\r\n**💡 入力のコツ：**\r\n- **SKU**: AmazonのCSVファイルと**完全一致**させること\r\n- **税抜き原価**: 仕入れ単価（数値のみ入力）\r\n- **倍率**: 通常は `1.0`（特別な計算が必要な場合のみ変更）\r\n\r\n**🔄 最新機能：SKU正規化**\r\n- システムが自動でSKUを統一フォーマットに変換\r\n- L始まりのSKUは小文字に統一（L0872 → l0872）\r\n- 接尾辞の自動削除（`_pre`, `-back`等）\r\n\r\n---\r\n\r\n## ⚡ 日常運用（3ステップで完了）\r\n\r\n### 🔄 月次在庫取り込み手順\r\n\r\n#### Step 1: CSVファイルの準備\r\n1. **Amazonセラーセントラル**から在庫レポートをダウンロード\r\n2. **Googleドライブの指定フォルダ**にアップロード\r\n   ```\r\n   フォルダURL: https://drive.google.com/drive/folders/1p35ywx2cQvBA8ALyS3ted5OITei4XAXJ\r\n   ```\r\n3. ファイル名は何でもOK（最新ファイルを自動選択）\r\n\r\n#### Step 2: 自動取り込み実行\r\n1. **スプレッドシートを開く**\r\n2. **「棚卸しシステム」→「📥 在庫データ取り込み実行」**をクリック\r\n3. **待つ**（10-30秒で完了）\r\n\r\n#### Step 3: 結果確認\r\n**「Amazon月末在庫」タブ**に以下が自動生成されます：\r\n\r\n| 項目 | 説明 | 自動/手動 |\r\n|------|------|-----------|\r\n| SKU | 商品コード | 🤖 自動 |\r\n| 商品名 | 商品名称 | 🤖 自動 |\r\n| 倉庫在庫数 | FBA倉庫の在庫 | 🤖 自動 |\r\n| 全在庫数 | 総在庫数 | 🤖 自動計算 |\r\n| **EFから納品前の在庫数** | 輸送中在庫 | ✋ **手動入力** |\r\n| **レポートから追加修正した分** | 調整分 | ✋ **手動入力** |\r\n| 税抜き原価 | 単価 | 🤖 自動 |\r\n| 税抜き原価合計 | 在庫金額 | 🤖 自動計算 |\r\n| 倍率反映後の税抜き原価合計 | 最終金額 | 🤖 自動計算 |\r\n\r\n### 📝 手動調整が必要な項目\r\n\r\n**以下の2列だけ手動で入力・更新してください：**\r\n\r\n1. **EFから納品前の在庫数**\r\n   - FBA倉庫への輸送中の商品数\r\n   - 次回取り込み時も値が保持されます\r\n\r\n2. **レポートから追加修正した分**\r\n   - 棚卸し差異や調整値\r\n   - 次回取り込み時も値が保持されます\r\n\r\n---\r\n\r\n## 🔄 他システムとの連携\r\n\r\n### 🏭 EF（加島商事）システムとの連携\r\n\r\n**統合在庫管理**として、以下の連携が可能です：\r\n\r\n- **在庫データ統合**: FBA在庫 + EF在庫 = 全社在庫把握\r\n- **月次変動分析**: 両システムのデータを統合した変動レポート\r\n- **統一SKU管理**: 共通の正規化ルールによる一元管理\r\n\r\n### 📊 月次統合レポートとの連携\r\n\r\n**包括的な分析**が自動実行されます：\r\n\r\n- **入出荷履歴統合**: Amazon・楽天・EF全体の月次動向\r\n- **差異分析**: 予測変動数と実際変動数の比較\r\n- **在庫効率分析**: 回転率・デッドストック分析\r\n\r\n---\r\n\r\n## 🔧 トラブルシューティング\r\n\r\n### ❌ よくあるエラーと解決方法\r\n\r\n#### 「指定フォルダにCSVファイルが見つかりません」\r\n**🔍 確認ポイント：**\r\n- ✅ Googleドライブにファイルがアップロードされているか\r\n- ✅ ファイル形式が`.csv`か\r\n- ✅ フォルダIDが正しいか\r\n\r\n#### 「SKU列が見つかりません」\r\n**🔍 確認ポイント：**\r\n- ✅ CSVに「出品者SKU」または「SKU」列があるか\r\n- ✅ 列名に余分なスペースがないか\r\n- ✅ ヘッダー行が1行目にあるか\r\n\r\n#### 「出力タブが見つかりません」\r\n**🔍 解決方法：**\r\n- 🔄 もう一度「在庫データ取り込み実行」を実行\r\n- 📊 「Amazon月末在庫」タブが自動作成されます\r\n\r\n### ⚙️ 設定変更\r\n\r\n**「棚卸しシステム」→「⚙️ 設定変更」**から変更可能：\r\n\r\n- **入力フォルダID**: CSVファイル保存先\r\n- **出力シートID**: 結果出力先のスプレッドシート\r\n- **出力タブ名**: 出力先のシート名\r\n- **マスタータブ名**: 商品マスターデータのシート名\r\n\r\n### 🆕 エンコーディング自動判定機能\r\n\r\n**最新の技術改良**：\r\n- **Shift_JIS/UTF-8自動判定**: 文字化け問題を自動解決\r\n- **エラー詳細ログ**: 問題箇所を特定しやすい詳細なエラー表示\r\n- **データ検証強化**: 不正なデータの事前チェック\r\n\r\n---\r\n\r\n## 📊 システム仕組み解説\r\n\r\n### 🔄 データの流れ\r\n\r\n```\r\n📄 AmazonのCSVファイル\r\n           ↓\r\n📁 Googleドライブフォルダ\r\n           ↓\r\n🤖 FBA棚卸しシステム（自動処理）\r\n    ↓               ↓\r\n📋 在庫データ    📋 マスターデータ\r\n    ↓               ↓\r\n📊 Amazon月末在庫シート\r\n           ↓\r\n🔗 統合システム連携\r\n           ↓\r\n📈 月次統合レポート\r\n           ↓\r\n💰 全社在庫分析完了！\r\n```\r\n\r\n### 🧮 自動計算式\r\n\r\n- **全在庫数** = 倉庫在庫数 + EFから納品前の在庫数 + 修正分\r\n- **税抜き原価合計** = 全在庫数 × 税抜き原価  \r\n- **最終金額** = 税抜き原価合計 × 倍率\r\n\r\n### 🔧 技術的特徴（2025年8月改良版）\r\n\r\n**パフォーマンス向上**：\r\n- **大容量CSV対応**: 10,000行以上のデータも高速処理\r\n- **メモリ効率化**: バッチ処理による処理速度向上\r\n- **エラーハンドリング強化**: 予期しない形式のCSVにも対応\r\n\r\n**信頼性向上**：\r\n- **データバックアップ**: 処理前に自動バックアップ作成\r\n- **ロールバック機能**: 問題発生時の自動復旧\r\n- **進捗表示**: リアルタイム処理状況の表示\r\n\r\n---\r\n\r\n## 💡 運用のベストプラクティス\r\n\r\n### 📅 推奨月次サイクル\r\n\r\n1. **月初（1-3日）**\r\n   - 前月末のCSVファイルをダウンロード・アップロード\r\n\r\n2. **在庫取り込み（月初）**\r\n   - システム実行で倉庫在庫を更新\r\n\r\n3. **手動調整（月初-中旬）**  \r\n   - EF在庫数と修正分を入力\r\n\r\n4. **統合分析（月中旬）**\r\n   - 他システム（RSL・EF）と統合レポート作成\r\n\r\n5. **最終確認（月末）**\r\n   - 全在庫数と在庫金額を確認・保存\r\n\r\n### 🎯 効率的な活用方法\r\n\r\n**📈 履歴管理**\r\n- 月ごとにシートをコピーして在庫推移を管理\r\n- 前年同月比較で在庫計画を立案\r\n\r\n**🔄 一括更新**\r\n- 原価や倍率変更時はマスターデータを更新→再取り込み\r\n- 複数商品の原価を一度に反映可能\r\n\r\n**📂 複数倉庫対応**  \r\n- フォルダを分けることで複数倉庫のデータを個別管理\r\n- 倉庫別の在庫金額を把握\r\n\r\n**🔗 システム統合活用**\r\n- FBA・RSL・EF全体での在庫最適化\r\n- チャネル別の在庫配分戦略\r\n- 統合月次レポートでの包括分析\r\n\r\n---\r\n\r\n## 🆕 最新機能・改良点（2025年8月版）\r\n\r\n### 🚀 新機能\r\n\r\n**1. SKU自動正規化機能**\r\n- L始まりSKUの小文字統一\r\n- 接尾辞の自動削除\r\n- 他システムとの統一規格\r\n\r\n**2. エンコーディング自動判定**\r\n- Shift_JIS/UTF-8の自動識別\r\n- 文字化け問題の自動解決\r\n\r\n**3. 統合システム連携対応**\r\n- 他在庫システムとのデータフォーマット統一\r\n- 月次統合レポートへの自動連携\r\n\r\n**4. エラーハンドリング強化**\r\n- 詳細なエラーログ表示\r\n- 自動復旧機能\r\n- データ検証機能の拡充\r\n\r\n### ⚡ パフォーマンス向上\r\n\r\n- **処理速度**: 従来比30%高速化\r\n- **メモリ使用量**: 大容量データ処理の最適化\r\n- **安定性**: エラー発生率を大幅削減\r\n\r\n---\r\n\r\n## ⚠️ 重要な注意事項\r\n\r\n### 🔒 データ管理\r\n- **CSVファイル**: Shift-JISまたはUTF-8エンコーディング対応\r\n- **SKUの自動整理**: 接尾辞（`_pre`, `-back`等）は自動削除\r\n- **数値フォーマット**: 自動的にカンマ区切りで表示\r\n\r\n### 🛡️ セキュリティ\r\n- **Googleアカウント認証**: 承認済みアカウントのみアクセス可能\r\n- **スプレッドシート権限**: 編集権限を持つユーザーのみ利用可能\r\n- **データバックアップ**: 処理前の自動バックアップで安全性確保\r\n\r\n### 🔄 システム統合時の注意\r\n- **他システム実行順序**: FBA→RSL→EF→統合レポートの順で実行推奨\r\n- **データ整合性**: 同一SKUが複数システムに存在する場合の重複チェック\r\n- **月次締め**: 全システム完了後に月次レポートを確定\r\n\r\n---\r\n\r\n## 📞 サポート情報\r\n\r\n### 🆕 システム情報\r\n- **現在のバージョン**: v2.0 (2025年8月) - 統合システム対応版\r\n- **対応ファイル形式**: CSV（Shift-JIS/UTF-8自動判定）\r\n- **対応ブラウザ**: Chrome、Firefox、Safari、Edge\r\n- **連携システム**: RSL棚卸し、EF棚卸し、月次統合レポート\r\n\r\n### 📋 よくある質問\r\n\r\n**Q: マスターデータに無いSKUはどうなりますか？**\r\nA: 在庫数は表示されますが、商品名と原価は空白になります。\r\n\r\n**Q: CSVファイルが複数ある場合はどうなりますか？**\r\nA: 最新の更新日時のファイルが自動選択されます。\r\n\r\n**Q: 手動調整値はいつリセットされますか？**\r\nA: リセットされません。意図的に変更するまで値が保持されます。\r\n\r\n**Q: 他システムとの連携はどのように行いますか？**\r\nA: 各システムを順次実行後、統合月次レポートシステムが自動的にデータを統合します。\r\n\r\n**Q: SKU正規化でデータが変わってしまうのですが？**\r\nA: 表示形式のみが統一され、元のデータは保持されています。必要に応じて設定で無効化可能です。\r\n\r\n### 🔧 お問い合わせ\r\n\r\nシステムに関するお問い合わせは、システム管理者またはIT部門にご連絡ください。\r\n\r\n---\r\n\r\n## 🎉 まとめ\r\n\r\nこのFBA棚卸しシステムと統合在庫管理システムを使うことで：\r\n\r\n✅ **月末棚卸し作業が10分に短縮**\r\n✅ **計算ミスがゼロ**  \r\n✅ **在庫金額の自動算出**\r\n✅ **履歴管理が簡単**\r\n✅ **複数チャネルの統合管理**\r\n✅ **予測分析と実績分析**\r\n✅ **システム間の自動連携**\r\n\r\n**🚀 統合在庫管理システムで、在庫管理の効率を劇的に改善しましょう！**\r\n\r\n**🔗 関連システム**\r\n- [RSL棚卸しシステム操作ガイド] - 楽天ロジとの連携\r\n- [EF棚卸しシステム操作ガイド] - 加島商事との統合管理  \r\n- [統合月次レポートシステム] - 全チャネル包括分析\r\n\r\n---\r\n\r\n*📅 最終更新: 2025年8月26日*\r\n*🔄 対応システム: FBA棚卸しシステム v2.0（統合対応版）*\r\n*🤝 連携システム: RSL・EF・月次レポート統合*",
  "draft": false,
  "archived": false,
  "url": "https://go.docbase.io/posts/3891568",
  "created_at": "2025-08-08T18:16:31+09:00",
  "published_at": "2025-08-08T18:16:31+09:00",
  "updated_at": "2025-08-27T08:07:00+09:00",
  "scope": "group",
  "tags": [
    {
      "name": "{\"name\"=>\"FBA棚卸し\"}"
    },
    {
      "name": "{\"name\"=>\"Amazon在庫管理\"}"
    },
    {
      "name": "{\"name\"=>\"Google Apps Script\"}"
    },
    {
      "name": "{\"name\"=>\"自動化システム\"}"
    },
    {
      "name": "{\"name\"=>\"操作マニュアル\"}"
    },
    {
      "name": "{\"name\"=>\"在庫管理\"}"
    },
    {
      "name": "{\"name\"=>\"月次処理\"}"
    }
  ],
  "user": {
    "id": 33561,
    "name": "前園 拓真",
    "profile_image_url": "https://image.docbase.io/uploads/6a7aed2f-593e-40e3-b18e-7a9d8b3b8df5-128x128c.jpg"
  },
  "stars_count": 0,
  "good_jobs_count": 0,
  "sharing_url": null,
  "representative_image_url": null,
  "comments_count": 0,
  "groups": [
    {
      "id": 14313,
      "name": "G.O / 加島（従業員のみ）"
    }
  ],
  "attachments": []
}